!function e(t,o,i){function n(r,l){if(!o[r]){if(!t[r]){var a="function"==typeof require&&require;if(!l&&a)return a(r,!0);if(s)return s(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var u=o[r]={exports:{}};t[r][0].call(u.exports,function(e){var o=t[r][1][e];return n(o||e)},u,u.exports,e,t,o,i)}return o[r].exports}for(var s="function"==typeof require&&require,r=0;r<i.length;r++)n(i[r]);return n}({1:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(e){this.HTMLElement=e,this.lazyloadEnabled=!1,this.autoRefreshEnabled=!1,this.autoRefreshCounter=1}return e}();o.AdSlot=i},{}],2:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=e("./logger"),n=e("./viewport");!function(e){function t(e,t,n){void 0===t&&(t={}),e.autoRefreshEnabled&&(e.autoRefreshCounter<=e.autoRefreshLimit?(i.Logger.infoWithTime(e.name,"refreshing in",e.autoRefreshTime,"seconds (",e.autoRefreshCounter,"/",e.autoRefreshLimit,")"),setTimeout(o,1e3*e.autoRefreshTime,e,n,t),e.autoRefreshCounter++):(e.autoRefreshEnabled=!1,i.Logger.infoWithTime(e.name,"auto refresh ended")))}function o(t,o,n){i.Logger.logWithTime(t.name,"starting refresh for auto rotate"),e.refreshIfViewable(t,o,n)}function s(t,o,s){if(document.hidden){i.Logger.logWithTime(t.name,"marked for refresh on visibilitychange");var r=function(){e.refreshIfViewable(t,o,s),document.removeEventListener("visibilitychange",r)};return void document.addEventListener("visibilitychange",r)}if(n.Viewport.getCurrentViewabilityPercentage(t.HTMLElement)>=50)o(t,s);else{i.Logger.logWithTime(t.name,"viewablity lower than 50%, not refreshing");var l=setInterval(function(){n.Viewport.getCurrentViewabilityPercentage(t.HTMLElement)>=50&&(o(t,s),clearInterval(l))},5e3)}}e.start=t,e.refreshIfViewable=s}(o.AutoRefresh||(o.AutoRefresh={}))},{"./logger":3,"./viewport":4}],3:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});!function(e){function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}function o(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];t(a(),"->",e.join(" "))}function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i(a(),"->",e.join(" "))}function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}function l(){}function a(){return(new Date).getHours()+":"+(new Date).getMinutes()+":"+(new Date).getSeconds()+"."+(new Date).getMilliseconds()}location.hash.indexOf("development");e.log=t,e.logWithTime=o,e.info=i,e.infoWithTime=n,e.warn=s,e.error=r,e.consoleWelcomeMessage=l}(o.Logger||(o.Logger={}))},{}],4:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});!function(e){function t(e,t){var o=e.getBoundingClientRect();return o.top>=0&&o.left>=0&&o.bottom-t<=(window.innerHeight||document.documentElement.clientHeight)&&o.right<=(window.innerWidth||document.documentElement.clientWidth)}function o(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}function i(e){var t=e.getBoundingClientRect().top,o=t>0?window.innerHeight-t:Math.abs(t),i=o/e.clientHeight;return i=t>0?i:1-i,i<0&&(i=0),i>1&&(i=1),100*i}e.isElementInViewport=t,e.isElementVisible=o,e.getCurrentViewabilityPercentage=i}(o.Viewport||(o.Viewport={}))},{}],5:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var adslot_1=require("../../modules/adslot"),DoubleClickAdSlot=function(_super){function DoubleClickAdSlot(HTMLElement){var _this=_super.call(this,HTMLElement)||this;_this.HTMLElement=HTMLElement;var ds=HTMLElement.dataset,size=eval(ds.madSize);return _this.adUnit=ds.madAdunit,_this.name=HTMLElement.id,_this.size=size,_this.isOutOfPage=Boolean(ds.madOutOfPage),_this.autoRefreshTime=Number(ds.madAutoRefreshInSeconds)||0,_this.autoRefreshLimit=Number(ds.madAutoRefreshLimit)||0,_this.lazyloadOffset=Number(ds.madLazyloadOffset),_this.autoRefreshEnabled=_this.autoRefreshTime>0,_this.lazyloadOffset&&(_this.lazyloadOffset=_this.lazyloadOffset||0,_this.lazyloadEnabled=!0),_this}return __extends(DoubleClickAdSlot,_super),DoubleClickAdSlot.prototype.defineSlot=function(){this.isOutOfPage?this.doubleclickAdSlot=googletag.defineOutOfPageSlot(this.adUnit,this.name).addService(googletag.pubads()):this.doubleclickAdSlot=googletag.defineSlot(this.adUnit,this.size,this.name).addService(googletag.pubads())},DoubleClickAdSlot.prototype.addSizeMapping=function(e){this.doubleclickAdSlot.defineSizeMapping(e)},DoubleClickAdSlot.prototype.addSetTargeting=function(e){this.doubleclickAdSlot.setTargeting("position",e)},DoubleClickAdSlot.prototype.addCollapseEmptyDivs=function(e,t){this.doubleclickAdSlot.setCollapseEmptyDiv(e,t)},DoubleClickAdSlot.prototype.display=function(){googletag.display(this.name)},DoubleClickAdSlot.prototype.refresh=function(){googletag.pubads().refresh([this.doubleclickAdSlot])},DoubleClickAdSlot.prototype.getDoubleclickAdSlot=function(){return this.doubleclickAdSlot},DoubleClickAdSlot}(adslot_1.AdSlot);exports.DoubleClickAdSlot=DoubleClickAdSlot},{"../../modules/adslot":1}],6:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=e("../doubleclick/doubleclick.adslot"),n=e("../../modules/logger"),s=e("../../modules/viewport"),r=e("../../modules/autorefresh"),l=function(){function e(){this.name="PrebidDfp",this.slots={},this.PREBID_TIMEOUT=3e3}return e.prototype.init=function(e){var t=this,o=[];return this.slots=this.getSlots(),this.PREBID_TIMEOUT=pbjs.getConfig().bidderTimeout,new Promise(function(i,s){function l(){pbjs.adserverRequestSent||(n.Logger.infoWithTime("Sending ad server request"),pbjs.adserverRequestSent=!0,googletag.cmd.push(function(){pbjs.que.push(function(){n.Logger.infoWithTime("setTargetingForGPTAsync called"),pbjs.setTargetingForGPTAsync(),e.logBids&&(n.Logger.infoWithTime("Bids returned, listing:"),n.Logger.log(pbjs.getAdserverTargeting()));for(var s in t.slots)t.slots[s].display(),n.Logger.logWithTime(t.slots[s].name,"started displaying"),t.slots[s].lazyloadEnabled||o.push(t.slots[s].doubleclickAdSlot);googletag.pubads().refresh(o),i()})}))}googletag.cmd.push(function(){googletag.pubads().enableSingleRequest(),googletag.pubads().disableInitialLoad(),n.Logger.info("enabling services"),googletag.enableServices()}),pbjs.que.push(function(){n.Logger.infoWithTime("Adding adunits to prebid..."),pbjs.addAdUnits(e.adUnits),n.Logger.infoWithTime("Requesting bids..."),pbjs.requestBids({adUnitCodes:e.initialAdUnits,bidsBackHandler:l})}),setTimeout(function(){n.Logger.infoWithTime("Timeout reached, will send ad server request"),l()},pbjs.getConfig().bidderTimeout),googletag.cmd.push(function(){for(var o in t.slots)t.slots[o].defineSlot(),n.Logger.log(t.name,"ad slot defined: ",t.slots[o]),e.sizes[o]&&t.slots[o].addSizeMapping(e.sizes[o]),e.target[o]&&t.slots[o].addSetTargeting(e.target[o]),e.collapse[o]?t.slots[o].addCollapseEmptyDivs(!0,!0):t.slots[o].addCollapseEmptyDivs(!0);for(var i in e.customTargets){var s=e.customTargets[i];n.Logger.log("targeting",i,"as",s),googletag.pubads().setTargeting(i,[s])}googletag.pubads().addEventListener("slotRenderEnded",function(o){n.Logger.logWithTime(o.slot.getSlotElementId(),"finished slot rendering");var i=t.slots[o.slot.getSlotElementId()],s=!0;for(var l in e.disableRotateList.lineItemIds)o.lineItemId==e.disableRotateList.lineItemIds[l]&&(s=!1);for(var l in e.disableRotateList.orderIds)o.campaignId==e.disableRotateList.orderIds[l]&&(s=!1);s&&r.AutoRefresh.start(i,e,t.autoRefresh),e.onSlotRenderEnded&&e.onSlotRenderEnded(o)}),t.onScrollRefreshLazyloadedSlots(e)}),document.addEventListener("madSlotLoaded",function(o){var i=o.detail;i=t.getSingleSlot(i),googletag.cmd.push(function(){for(var o in i)t.slots[o]=i[o],i[o].defineSlot(),n.Logger.log(t.name,"ad slot defined: ",i[o]),e.sizes[o]&&i[o].addSizeMapping(e.sizes[o]),e.target[o]&&i[o].addSetTargeting(e.target[o]),e.collapse[o]?i[o].addCollapseEmptyDivs(!0,!0):i[o].addCollapseEmptyDivs(!0),i[o].display(),t.autoRefresh(i[o],e)})})})},e.prototype.onScrollRefreshLazyloadedSlots=function(e){var t=this;window.addEventListener("scroll",function(e){for(var o in t.slots)!function(e){var o=t.slots[e];o.lazyloadEnabled&&s.Viewport.isElementInViewport(o.HTMLElement,o.lazyloadOffset)&&(pbjs.que.push(function(){pbjs.requestBids({adUnitCodes:[o.name],bidsBackHandler:function(){pbjs.setTargetingForGPTAsync([o.name]),o.refresh()}})}),o.lazyloadEnabled=!1)}(o)})},e.prototype.autoRefresh=function(e,t){n.Logger.logWithTime(e.name,"started refreshing"),pbjs.que.push(function(){pbjs.requestBids({adUnitCodes:[e.name],bidsBackHandler:function(){pbjs.setTargetingForGPTAsync([e.name]),e.refresh()}})})},e.prototype.getSingleSlot=function(e){var t={},o=e.HTMLElement;return t[o.id]=new i.DoubleClickAdSlot(o),window._molotovAds.slots[o.id]=t[o.id],t},e.prototype.getSlots=function(){var e={};for(var t in window._molotovAds.slots){var o=window._molotovAds.slots[t].HTMLElement;""!==o.dataset.madAdunit&&(e[o.id]=new i.DoubleClickAdSlot(o),window._molotovAds.slots[o.id]=e[o.id])}return e},e}();o.PrebidDfpPlugIn=l,window._molotovAds.loadPlugin(new l)},{"../../modules/autorefresh":2,"../../modules/logger":3,"../../modules/viewport":4,"../doubleclick/doubleclick.adslot":5}]},{},[6]);